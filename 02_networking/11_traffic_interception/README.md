# –¢–µ–º–∞ 11: –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞

## üìö –û–ø–∏—Å–∞–Ω–∏–µ

–ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ - –æ—Å–Ω–æ–≤–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∞—Ç–∞–∫ –∏ –∑–∞—â–∏—Ç—ã. –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è:
- –ê–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –∞—Ç–∞–∫
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ IDS/IPS —Å–∏—Å—Ç–µ–º
- –ü–æ–Ω–∏–º–∞–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤

## üéØ –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ (tcpdump, Wireshark)
- –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
- –ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## üîó –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–µ–º–∞–º–∏

### –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç–µ–º—ã
- [–¢–µ–º–∞ 8: TCP Client-Server](../08_tcp_client_server/) - –ø–æ–Ω–∏–º–∞–Ω–∏–µ TCP –ø—Ä–æ—Ç–æ–∫–æ–ª–∞

### –°–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã
- [–¢–µ–º–∞ 19: Suricata](../../06_security_tools/19_suricata/) - IDS/IPS –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
- [–¢–µ–º–∞ 21: DFIR](../../07_forensics/21_dfir/) - –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ñ–æ—Ä–µ–Ω–∑–∏–∫–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

```
11_traffic_interception/
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ examples/                    # –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)
```

## üöÄ –ó–∞–ø—É—Å–∫

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

```bash
# Ubuntu/Debian
sudo apt-get install tcpdump wireshark libpcap-dev

# Fedora
sudo dnf install tcpdump wireshark libpcap-devel

# macOS
brew install tcpdump wireshark
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ tcpdump

```bash
# –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
sudo tcpdump -i eth0

# –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ TCP —Ç—Ä–∞—Ñ–∏–∫
sudo tcpdump -i eth0 tcp

# –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—Ç—É
sudo tcpdump -i eth0 port 80

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –≤ —Ñ–∞–π–ª
sudo tcpdump -i eth0 -w capture.pcap

# –ß–∏—Ç–∞—Ç—å –∏–∑ —Ñ–∞–π–ª–∞
tcpdump -r capture.pcap
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Wireshark

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å Wireshark (GUI)
sudo wireshark

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å tshark (CLI)
sudo tshark -i eth0
```

## üìñ –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞?

–ü–µ—Ä–µ—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ (packet capture) - —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞—Ö–≤–∞—Ç–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
- –ê–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤
- –û—Ç–ª–∞–¥–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π –∏ –∞—Ç–∞–∫
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –ú–µ—Ç–æ–¥—ã –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞

**1. Promiscuous Mode (–ù–µ—Ä–∞–∑–±–æ—Ä—á–∏–≤—ã–π —Ä–µ–∂–∏–º):**
- –°–µ—Ç–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –ø–∞–∫–µ—Ç—ã, –Ω–µ —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –µ–º—É
- –¢—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ root/administrator
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è tcpdump, Wireshark

**2. Port Mirroring (SPAN):**
- –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å –æ–¥–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –Ω–∞ –¥—Ä—É–≥–æ–π
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ç–µ–≤–æ–º –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–∏
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∫–æ–Ω–µ—á–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

**3. TAP/TUN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:**
- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Ethernet Header‚îÇ 14 –±–∞–π—Ç
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   IP Header     ‚îÇ 20 –±–∞–π—Ç (IPv4)
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  TCP/UDP Header ‚îÇ 20/8 –±–∞–π—Ç
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ     Payload     ‚îÇ –î–∞–Ω–Ω—ã–µ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –§–∏–ª—å—Ç—Ä—ã tcpdump

**–ü–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É:**
```bash
tcpdump tcp          # –¢–æ–ª—å–∫–æ TCP
tcpdump udp          # –¢–æ–ª—å–∫–æ UDP
tcpdump icmp         # –¢–æ–ª—å–∫–æ ICMP
```

**–ü–æ –∞–¥—Ä–µ—Å—É:**
```bash
tcpdump host 192.168.1.1        # –¢—Ä–∞—Ñ–∏–∫ —Å/–Ω–∞ —Ö–æ—Å—Ç
tcpdump src 192.168.1.1         # –¢—Ä–∞—Ñ–∏–∫ –æ—Ç —Ö–æ—Å—Ç–∞
tcpdump dst 192.168.1.1          # –¢—Ä–∞—Ñ–∏–∫ –∫ —Ö–æ—Å—Ç—É
```

**–ü–æ –ø–æ—Ä—Ç—É:**
```bash
tcpdump port 80                 # –ü–æ—Ä—Ç 80
tcpdump src port 8080           # –ò—Å—Ö–æ–¥—è—â–∏–π —Å –ø–æ—Ä—Ç–∞ 8080
tcpdump dst port 443            # –í—Ö–æ–¥—è—â–∏–π –Ω–∞ –ø–æ—Ä—Ç 443
```

**–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ:**
```bash
tcpdump 'tcp and port 80 and host 192.168.1.1'
```

## üõ† –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –ü—Ä–∏–º–µ—Ä 1: –ü–µ—Ä–µ—Ö–≤–∞—Ç HTTP —Ç—Ä–∞—Ñ–∏–∫–∞

```bash
# –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å HTTP –∑–∞–ø—Ä–æ—Å—ã
sudo tcpdump -i eth0 -A 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
sudo tcpdump -i eth0 -w http_capture.pcap 'tcp port 80'
```

### –ü—Ä–∏–º–µ—Ä 2: –ê–Ω–∞–ª–∏–∑ DNS –∑–∞–ø—Ä–æ—Å–æ–≤

```bash
# –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å DNS –∑–∞–ø—Ä–æ—Å—ã
sudo tcpdump -i eth0 -n 'udp port 53'

# –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
sudo tcpdump -i eth0 -v 'udp port 53'
```

### –ü—Ä–∏–º–µ—Ä 3: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞

–°–º. [examples/recover_files.cpp](./examples/recover_files.cpp) - –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

1. **–ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –∞–Ω–∞–ª–∏–∑:**
   - –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
   - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–∫–µ—Ç–æ–≤
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª –∏ –¥–∞–Ω–Ω—ã–µ

2. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞:**
   - –°–æ–∑–¥–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
   - –ò–∑–≤–ª–µ—á—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ –ø–∞–∫–µ—Ç—ã

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
   - –ü–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É —Ñ–∞–π–ª–∞
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

## üîç –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

1. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É promiscuous mode –∏ –æ–±—ã—á–Ω—ã–º —Ä–µ–∂–∏–º–æ–º —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞?
2. –ö–∞–∫–∏–µ –ø—Ä–∞–≤–∞ –Ω—É–∂–Ω—ã –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞?
3. –ö–∞–∫ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –±–µ–∑ –ø—Ä–∞–≤ root?
4. –ö–∞–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –º–æ–∂–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é tcpdump?
5. –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è –æ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Ç—Ä–∞—Ñ–∏–∫–∞?
6. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É tcpdump –∏ Wireshark?
7. –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª –∏–∑ –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤?

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Wireshark Documentation](https://www.wireshark.org/docs/)
- [tcpdump manual](https://www.tcpdump.org/manpages/tcpdump.1.html)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ë–∞–∑–æ–≤—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã —Å–æ–∑–¥–∞–Ω—ã  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025

