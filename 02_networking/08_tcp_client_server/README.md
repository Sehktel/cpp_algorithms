# –¢–µ–º–∞ 8: TCP Client-Server –Ω–∞ C++

## üìö –û–ø–∏—Å–∞–Ω–∏–µ

TCP (Transmission Control Protocol) - –Ω–∞–¥–µ–∂–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—É—é –∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É –¥–∞–Ω–Ω—ã—Ö. –ü–æ–Ω–∏–º–∞–Ω–∏–µ TCP –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è:
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ê–Ω–∞–ª–∏–∑–∞ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞
- –°–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (IDS/IPS, –ø—Ä–æ–∫—Å–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- –ü–æ–Ω–∏–º–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤ —Å–µ—Ç–µ–≤—ã—Ö –∞—Ç–∞–∫

## üéØ –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è

- –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä
- –†–∞–±–æ—Ç–∞ —Å —Å–æ–∫–µ—Ç–∞–º–∏ (sockets) –≤ C++
- –†–µ–∞–ª–∏–∑–∞—Ü–∏—è TCP —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–µ—Ç–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–µ—Ç–µ–≤–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

## üîó –°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ —Ç–µ–º–∞–º–∏

### –ü—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç–µ–º—ã
- [–¢–µ–º–∞ 4: –°–∏–≥–Ω–∞–ª—ã](../../01_cpp_fundamentals/04_signals/) - graceful shutdown —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ SIGTERM/SIGINT
- [–¢–µ–º–∞ 6: CLI args](../../01_cpp_fundamentals/06_cli_args/) - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—Ç–æ–≤ –∏ –∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
- [–¢–µ–º–∞ 7: File I/O](../../01_cpp_fundamentals/07_file_io/) - –ø–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–µ—Ç–∏

### –°–ª–µ–¥—É—é—â–∏–µ —Ç–µ–º—ã
- [–¢–µ–º–∞ 11: Traffic interception](../11_traffic_interception/) - –ø–µ—Ä–µ—Ö–≤–∞—Ç –∏ –∞–Ω–∞–ª–∏–∑ TCP —Ç—Ä–∞—Ñ–∏–∫–∞
- [–¢–µ–º–∞ 12: strace/ltrace](../../03_debugging_analysis/12_strace_ltrace/) - –∞–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Å–µ—Ç–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [–¢–µ–º–∞ 19: Suricata](../../06_security_tools/19_suricata/) - IDS/IPS –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ TCP —Ç—Ä–∞—Ñ–∏–∫–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã

```
08_tcp_client_server/
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ CMakeLists.txt              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ Makefile                    # –ü—Ä–∞–≤–∏–ª–∞ —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ simple/                      # –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ simple_server.cpp
‚îÇ   ‚îú‚îÄ‚îÄ simple_client.cpp
‚îÇ   ‚îî‚îÄ‚îÄ SIMPLE_DEMO.md
‚îú‚îÄ‚îÄ advanced/                    # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ server.cpp
‚îÇ   ‚îî‚îÄ‚îÄ client.cpp
‚îú‚îÄ‚îÄ ping_pong/                   # Ping-Pong –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ ping_pong_server.cpp
‚îÇ   ‚îú‚îÄ‚îÄ ping_pong_client.cpp
‚îÇ   ‚îú‚îÄ‚îÄ settings.ini
‚îÇ   ‚îú‚îÄ‚îÄ test_message.txt
‚îÇ   ‚îî‚îÄ‚îÄ PING_PONG_README.md
‚îî‚îÄ‚îÄ netcat/                      # Netcat –Ω–∞ C++
    ‚îú‚îÄ‚îÄ netcat_server.cpp
    ‚îú‚îÄ‚îÄ netcat_client.cpp
    ‚îú‚îÄ‚îÄ network_file_transfer_theory.md
    ‚îî‚îÄ‚îÄ Makefile
```

## üöÄ –ó–∞–ø—É—Å–∫

### –ü—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã (simple/)

```bash
# –ö–æ–º–ø–∏–ª—è—Ü–∏—è
cd simple
g++ -std=c++17 -Wall -Wextra simple_server.cpp -o simple_server
g++ -std=c++17 -Wall -Wextra simple_client.cpp -o simple_client

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
./simple_server

# –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞ (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
./simple_client
```

### Ping-Pong –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
cd ping_pong

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ CMake
mkdir build && cd build
cmake ..
cmake --build .

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
./ping_pong_server

# –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
./ping_pong_client
```

### Netcat

```bash
cd netcat
make

# –°–µ—Ä–≤–µ—Ä
./netcat_server -o output.txt -p 8080

# –ö–ª–∏–µ–Ω—Ç
./netcat_client -i input.txt -p 8080
```

## üìñ –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä

**–°–µ—Ä–≤–µ—Ä:**
```
socket() ‚Üí bind() ‚Üí listen() ‚Üí accept() ‚Üí recv()/send() ‚Üí close()
```

**–ö–ª–∏–µ–Ω—Ç:**
```
socket() ‚Üí connect() ‚Üí send()/recv() ‚Üí close()
```

### TCP Socket API

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–∫–µ—Ç–∞:**
```cpp
int sockfd = socket(AF_INET, SOCK_STREAM, 0);
// AF_INET - IPv4
// SOCK_STREAM - TCP (–Ω–∞–¥–µ–∂–Ω—ã–π, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–π)
```

**–ü—Ä–∏–≤—è–∑–∫–∞ –∫ –∞–¥—Ä–µ—Å—É (—Å–µ—Ä–≤–µ—Ä):**
```cpp
struct sockaddr_in addr;
addr.sin_family = AF_INET;
addr.sin_port = htons(8080);
addr.sin_addr.s_addr = INADDR_ANY;  // –í—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

bind(sockfd, (struct sockaddr*)&addr, sizeof(addr));
```

**–ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ (—Å–µ—Ä–≤–µ—Ä):**
```cpp
listen(sockfd, 5);  // –û—á–µ—Ä–µ–¥—å –¥–æ 5 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
```

**–ü—Ä–∏–Ω—è—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Å–µ—Ä–≤–µ—Ä):**
```cpp
int client_fd = accept(sockfd, NULL, NULL);
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–∫–ª–∏–µ–Ω—Ç):**
```cpp
struct sockaddr_in server_addr;
server_addr.sin_family = AF_INET;
server_addr.sin_port = htons(8080);
inet_pton(AF_INET, "127.0.0.1", &server_addr.sin_addr);

connect(sockfd, (struct sockaddr*)&server_addr, sizeof(server_addr));
```

**–û—Ç–ø—Ä–∞–≤–∫–∞/–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
```cpp
send(sockfd, buffer, size, 0);
recv(sockfd, buffer, size, 0);
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å TCP

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **SYN flood** - –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- **TCP hijacking** - –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **Man-in-the-Middle** - –ø–µ—Ä–µ—Ö–≤–∞—Ç –∏ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞
- **Buffer overflow** - –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–æ–≤ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

**–ó–∞—â–∏—Ç–∞:**
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TLS/SSL –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

## üõ† –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–µ—Ä (simple_server.cpp)

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –°–æ–∑–¥–∞–Ω–∏–µ TCP —Å–æ–∫–µ—Ç–∞
- –ü—Ä–∏–≤—è–∑–∫—É –∫ –ø–æ—Ä—Ç—É
- –ü—Ä–∏–Ω—è—Ç–∏–µ –æ–¥–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –≠—Ö–æ-—Å–µ—Ä–≤–µ—Ä (–æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

### –ü—Ä–∏–º–µ—Ä 2: Ping-Pong –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞ (settings.ini)
- –ü–µ—Ä–µ–¥–∞—á—É —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–µ—Ç–∏
- –û–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
- –û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### –ü—Ä–∏–º–µ—Ä 3: Netcat –Ω–∞ C++

–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:
- –ü–µ—Ä–µ–¥–∞—á—É —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ —Å–æ–∫–µ—Ç—ã
- –û–±—Ä–∞–±–æ—Ç–∫—É –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è

1. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `pthread` –∏–ª–∏ `std::thread`

2. **Graceful shutdown:**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ SIGTERM/SIGINT
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –±—É—Ñ–µ—Ä–∞

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

## üîç –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏

1. –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É TCP –∏ UDP?
2. –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç—Ä–µ—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ —Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ (three-way handshake)?
3. –ö–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ?
4. –ö–∞–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤ TCP –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö?
5. –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–∞–¥–µ–∂–Ω—É—é –ø–µ—Ä–µ–¥–∞—á—É –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤?

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **README_network_ping_pong.md** - –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Ping-Pong –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **simple/SIMPLE_DEMO.md** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏
- **netcat/network_file_transfer_theory.md** - –¢–µ–æ—Ä–∏—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤ –ø–æ —Å–µ—Ç–∏
- [Beej's Guide to Network Programming](https://beej.us/guide/bgnet/)
- [TCP/IP Protocol Suite](https://en.wikipedia.org/wiki/Internet_protocol_suite)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** `network_ping-pong/`, `cpp_netcat/`, `file_read_write/ping_pong*` (legacy)  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025

