# Алгоритм Флойда-Уоршелла (Floyd-Warshall Algorithm)

## Описание

Алгоритм Флойда-Уоршелла — это алгоритм для поиска кратчайших путей между **всеми парами вершин** в взвешенном ориентированном графе. Он использует метод динамического программирования и работает даже с отрицательными весами рёбер (но не с отрицательными циклами).

## Ключевые особенности

- **Находит все кратчайшие пути**: между каждой парой вершин
- **Динамическое программирование**: строит решение пошагово
- **Работает с отрицательными весами**: но обнаруживает отрицательные циклы
- **Временная сложность**: O(V³)
- **Пространственная сложность**: O(V²)
- **Простая реализация**: три вложенных цикла

## Как работает алгоритм

### Основная идея

Для каждой вершины k алгоритм проверяет, можно ли улучшить путь между любыми двумя вершинами i и j, пройдя через вершину k.

```
dist[i][j] = min(dist[i][j], dist[i][k] + dist[k][j])
```

### Алгоритм (псевдокод)

```
1. Инициализация:
   - dist[i][j] = вес ребра (i, j), если ребро существует
   - dist[i][j] = ∞, если ребра нет
   - dist[i][i] = 0

2. Для каждой промежуточной вершины k от 0 до V-1:
     Для каждой пары вершин (i, j):
       Если dist[i][k] + dist[k][j] < dist[i][j]:
         dist[i][j] = dist[i][k] + dist[k][j]
         next[i][j] = next[i][k]  // для восстановления пути

3. Проверка отрицательных циклов:
   Если dist[i][i] < 0 для любого i, то есть отрицательный цикл
```

## Пример работы

### Граф
```
    0 --4--> 1
    |        |
    2        1
    ↓        ↓
    2 --2--> 3
```

### Матрица расстояний (начальная)
```
     0   1   2   3
   ----------------
0 |  0   4   ∞   ∞
1 |  ∞   0   ∞   1
2 |  ∞   ∞   0   2
3 |  ∞   ∞   ∞   0
```

### После алгоритма
```
     0   1   2   3
   ----------------
0 |  0   4   2   4
1 |  ∞   0   ∞   1
2 |  ∞   ∞   0   2
3 |  ∞   ∞   ∞   0
```

Путь 0→3: 0→2→3 (длина: 4)

## Сравнение с другими алгоритмами

| Алгоритм | Задача | Сложность | Отриц. веса |
|----------|--------|-----------|-------------|
| **Floyd-Warshall** | Все пары вершин | O(V³) | ✓ (обнаруживает циклы) |
| **Dijkstra** | Один источник | O(E log V) | ✗ |
| **Bellman-Ford** | Один источник | O(VE) | ✓ |
| **BFS** | Один источник (невзв.) | O(V + E) | N/A |

## Когда использовать

### ✅ Хорошо подходит для:
- Поиска кратчайших путей между всеми парами вершин
- Плотных графов (много рёбер)
- Небольших графов (до ~500 вершин)
- Графов с отрицательными весами
- Проверки транзитивного замыкания
- Задач, требующих знание всех расстояний

### ❌ Не подходит для:
- Больших разреженных графов (слишком медленно)
- Графов с отрицательными циклами (может обнаружить, но не решить)
- Когда нужен путь только от одного источника (используйте Dijkstra)

## Применение

1. **Маршрутизация в сетях**: протокол OSPF
2. **Графы знаний**: поиск связей между объектами
3. **Транзитивное замыкание**: достижимость в графе
4. **Обнаружение циклов**: проверка зависимостей
5. **Геометрические задачи**: расстояния между точками

## Компиляция и запуск

```bash
# Компиляция
g++ -std=c++11 -o floyd_warshall simple_floyd_warshall.cxx

# Запуск
./floyd_warshall
```

## Особенности реализации

### Режим verbose
Программа поддерживает детальный вывод работы алгоритма:
- Показывает каждую итерацию (промежуточную вершину)
- Выводит улучшения расстояний
- Показывает восстановление путей
- Визуализирует матрицу расстояний на каждом шаге

### Восстановление путей
Алгоритм не только находит длину кратчайшего пути, но и может восстановить сам путь с помощью матрицы `next[i][j]`.

## Временная сложность

- **O(V³)**: три вложенных цикла по всем вершинам
- Для графа с 100 вершинами: ~1 000 000 операций
- Для графа с 1000 вершинами: ~1 000 000 000 операций

## Пространственная сложность

- **O(V²)**: для хранения матрицы расстояний
- **O(V²)**: для хранения матрицы путей
- **Итого**: O(V²)

## Оптимизации

1. **Обнаружение отрицательных циклов**: проверяем диагональ после алгоритма
2. **Ранний выход**: если на итерации k не было улучшений, можно остановиться
3. **Битовая матрица**: для транзитивного замыкания можно использовать биты

## Интересные факты

- Назван в честь Роберта Флойда и Стивена Уоршелла (1962)
- Независимо открыт Бернардом Роем (1959)
- Является частным случаем умножения матриц в тропической алгебре
- Можно модифицировать для поиска максимальных путей

## Связь с другими алгоритмами

- **Умножение матриц**: похожая структура циклов
- **Транзитивное замыкание**: заменяем + на OR, min на AND
- **Алгоритм Уоршелла**: для вычисления транзитивного замыкания
- **Алгоритм Прима/Дейкстры**: другой подход к путям в графах

## Дополнительные задачи

1. Модифицировать для подсчёта количества путей
2. Найти путь с максимальной пропускной способностью
3. Определить диаметр графа (максимальное кратчайшее расстояние)
4. Найти центр графа (вершина с минимальным эксцентриситетом)

